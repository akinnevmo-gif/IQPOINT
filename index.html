<!DOCTYPE html>
<html lang="en">
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>OneLife | Gospel Dashboard</title>

<!-- PWA META -->
<meta name="theme-color" content="#000000">
<meta name="description" content="OneLife Gospel Experience - Word, Worship, Prayer and Encouragement">
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="icons/icon-192.png">

<!-- iOS Support -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">

<style>

/* ========================================= */
/* GLOBAL BACKGROUND */
/* ========================================= */

body {
    margin: 0;
    font-family: 'Segoe UI', sans-serif;
    background: linear-gradient(135deg, black, red, green, blue, purple);
    background-size: 400% 400%;
    animation: rainbowBG 18s ease infinite;
    color: white;
}

@keyframes rainbowBG {
    0% {background-position:0% 50%;}
    50% {background-position:100% 50%;}
    100% {background-position:0% 50%;}
}

/* ========================================= */
/* HEADER */
/* ========================================= */

header {
    text-align: center;
    padding: 25px;
    font-size: 30px;
    font-weight: bold;
    background: rgba(0,0,0,0.7);
    letter-spacing: 2px;
}

/* ========================================= */
/* CONTAINER */
/* ========================================= */

.container {
    padding: 40px;
    max-width: 1200px;
    margin: auto;
}

/* ========================================= */
/* DASHBOARD GRID */
/* ========================================= */

.dashboard {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 25px;
}

/* ========================================= */
/* CARDS */
/* ========================================= */

.card {
    background: rgba(255,255,255,0.08);
    padding: 30px;
    border-radius: 25px;
    text-align: center;
    cursor: pointer;
    transition: 0.4s;
    backdrop-filter: blur(8px);
    box-shadow: 0 20px 40px rgba(0,0,0,0.7);
}

.card:hover {
    transform: scale(1.07) rotateX(6deg);
}

/* ========================================= */
/* INSTALL BUTTON */
/* ========================================= */

.install-btn {
    display: none;
    margin: 20px auto;
    padding: 12px 30px;
    border-radius: 30px;
    border: none;
    background: linear-gradient(45deg, red, green, blue, purple);
    color: white;
    font-weight: bold;
    cursor: pointer;
}

/* ========================================= */
/* OFFLINE STATUS */
/* ========================================= */

.status {
    text-align: center;
    margin-top: 10px;
    font-size: 14px;
}

.online { color: lightgreen; }
.offline { color: red; }

@media(max-width:768px){
    .container { padding: 20px; }
}

</style>
</head>

<body>

<header>üåà OneLife Dashboard</header>

<button class="install-btn" id="installBtn">Install OneLife</button>

<div class="status" id="statusText"></div>

<div class="container">
<div class="dashboard">

<div class="card" onclick="location.href='cross.html'">‚úù 3D Cross Experience</div>
<div class="card" onclick="location.href='worship.html'">üéµ Worship Player</div>
<div class="card" onclick="location.href='bible-search.html'">üìñ Bible Search</div>
<div class="card">üôè Prayer Room</div>
<div class="card">üí¨ Motivation</div>
<div class="card">üìú Teachings</div>

</div>
</div>

<script>

/* ========================================= */
/* SERVICE WORKER REGISTRATION */
/* ========================================= */

if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('service-worker.js')
        .then(reg => {
            console.log("Service Worker Registered", reg);

            reg.onupdatefound = () => {
                const newWorker = reg.installing;
                newWorker.onstatechange = () => {
                    if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                        if(confirm("New update available. Refresh now?")){
                            window.location.reload();
                        }
                    }
                };
            };

        })
        .catch(err => console.log("SW registration failed", err));
}

/* ========================================= */
/* INSTALL PROMPT */
/* ========================================= */

let deferredPrompt;
const installBtn = document.getElementById("installBtn");

window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
    installBtn.style.display = "block";
});

installBtn.addEventListener('click', async () => {
    installBtn.style.display = "none";
    deferredPrompt.prompt();
    const choiceResult = await deferredPrompt.userChoice;
    if (choiceResult.outcome === 'accepted') {
        console.log('User accepted install');
    }
    deferredPrompt = null;
});

/* ========================================= */
/* ONLINE / OFFLINE DETECTION */
/* ========================================= */

const statusText = document.getElementById("statusText");

function updateOnlineStatus() {
    if (navigator.onLine) {
        statusText.textContent = "You are Online";
        statusText.className = "status online";
    } else {
        statusText.textContent = "You are Offline (PWA Mode Active)";
        statusText.className = "status offline";
    }
}

window.addEventListener('online', updateOnlineStatus);
window.addEventListener('offline', updateOnlineStatus);
updateOnlineStatus();

/* ========================================= */
/* ANIMATED TITLE EFFECT */
/* ========================================= */

let titleIndex = 0;
const titleText = "OneLife Gospel Experience";
setInterval(() => {
    document.title = titleText.substring(0, titleIndex++);
    if(titleIndex > titleText.length) titleIndex = 0;
}, 300);

</script>

</body>
</html>
