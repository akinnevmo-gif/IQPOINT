<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OneLife Consultant</title>
<style>
body{
    margin:0;
    font-family:'Segoe UI',sans-serif;
    background: linear-gradient(135deg, black, red, green, blue, purple);
    color:white;
    display:flex;
    flex-direction:column;
    height:100vh;
}
header{
    text-align:center;
    padding:20px;
    font-size:28px;
    font-weight:bold;
    background: rgba(0,0,0,0.7);
}
#chatContainer{
    flex:1;
    overflow-y:auto;
    padding:20px;
}
.message{
    background: rgba(255,255,255,0.08);
    margin:10px 0;
    padding:15px;
    border-radius:15px;
}
.user{background: rgba(0,150,255,0.4);}
.bot{background: rgba(0,255,100,0.2);}
#inputForm{
    display:flex;
    padding:10px;
    background: rgba(0,0,0,0.7);
}
#userInput{
    flex:1;
    padding:10px;
    border-radius:20px;
    border:none;
    outline:none;
}
#sendBtn{
    padding:10px 20px;
    margin-left:10px;
    border:none;
    border-radius:20px;
    background: linear-gradient(45deg, red, green, blue, purple);
    cursor:pointer;
}
</style>
</head>
<body>

<header>ðŸ¤– OneLife Consultant</header>
<div id="chatContainer"></div>

<form id="inputForm">
<input type="text" id="userInput" placeholder="Ask me anything..." required />
<button type="submit" id="sendBtn">Send</button>
</form>

<script>
const chatContainer = document.getElementById("chatContainer");
const inputForm = document.getElementById("inputForm");
const userInput = document.getElementById("userInput");

async function sendMessage(message){
    // Show user message
    const userDiv = document.createElement("div");
    userDiv.classList.add("message","user");
    userDiv.textContent = message;
    chatContainer.appendChild(userDiv);
    chatContainer.scrollTop = chatContainer.scrollHeight;

    // Call backend for OpenAI
    try{
        const res = await fetch('/api/openai', {
            method:'POST',
            headers:{'Content-Type':'application/json'},
            body: JSON.stringify({prompt: message})
        });
        const data = await res.json();
        const botDiv = document.createElement("div");
        botDiv.classList.add("message","bot");
        botDiv.textContent = data.reply || "Sorry, I couldn't process that.";
        chatContainer.appendChild(botDiv);
        chatContainer.scrollTop = chatContainer.scrollHeight;
    }catch(err){
        const botDiv = document.createElement("div");
        botDiv.classList.add("message","bot");
        botDiv.textContent = "Error connecting to OneLife Consultant.";
        chatContainer.appendChild(botDiv);
        chatContainer.scrollTop = chatContainer.scrollHeight;
        console.error(err);
    }
}

inputForm.addEventListener("submit",e=>{
    e.preventDefault();
    if(userInput.value.trim() !== ""){
        sendMessage(userInput.value.trim());
        userInput.value="";
    }
});
</script>

</body>
</html>
